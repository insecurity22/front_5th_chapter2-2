import{u as $,j as e,r as h,c as F,R as E}from"./useCart-BGjFYUAa.js";const R=({products:m,coupons:b})=>{const{cart:x,addToCart:y,removeFromCart:g,updateQuantity:v,getRemainingStock:f,applyCoupon:a,selectedCoupon:c,calculateTotal:i}=$(),{totalBeforeDiscount:u,totalAfterDiscount:o,totalDiscount:j}=i(),w=t=>t.reduce((d,p)=>Math.max(d,p.rate),0),C=t=>{const{discounts:d}=t.product,{quantity:p}=t;let N=0;for(const k of d)p>=k.quantity&&(N=Math.max(N,k.rate));return N};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"장바구니"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"상품 목록"}),e.jsx("div",{className:"space-y-2",children:m.map(t=>{const d=f(t);return e.jsxs("div",{"data-testid":`product-${t.id}`,className:"bg-white p-3 rounded shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-gray-600",children:[t.price.toLocaleString(),"원"]})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:[e.jsxs("span",{className:`font-medium ${d>0?"text-green-600":"text-red-600"}`,children:["재고: ",d,"개"]}),t.discounts.length>0&&e.jsxs("span",{className:"ml-2 font-medium text-blue-600",children:["최대"," ",(w(t.discounts)*100).toFixed(0),"% 할인"]})]}),t.discounts.length>0&&e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-500 mb-2",children:t.discounts.map((p,N)=>e.jsxs("li",{children:[p.quantity,"개 이상:"," ",(p.rate*100).toFixed(0),"% 할인"]},N))}),e.jsx("button",{onClick:()=>y(t),className:`w-full px-3 py-1 rounded ${d>0?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:d<=0,children:d>0?"장바구니에 추가":"품절"})]},t.id)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"장바구니 내역"}),e.jsx("div",{className:"space-y-2",children:x.map(t=>{const d=C(t);return e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded shadow",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:t.product.name}),e.jsx("br",{}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.product.price,"원 x ",t.quantity,d>0&&e.jsxs("span",{className:"text-green-600 ml-1",children:["(",(d*100).toFixed(0),"% 할인 적용)"]})]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>v(t.product.id,t.quantity-1),className:"bg-gray-300 text-gray-800 px-2 py-1 rounded mr-1 hover:bg-gray-400",children:"-"}),e.jsx("button",{onClick:()=>v(t.product.id,t.quantity+1),className:"bg-gray-300 text-gray-800 px-2 py-1 rounded mr-1 hover:bg-gray-400",children:"+"}),e.jsx("button",{onClick:()=>g(t.product.id),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"삭제"})]})]},t.product.id)})}),e.jsxs("div",{className:"mt-6 bg-white p-4 rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"쿠폰 적용"}),e.jsxs("select",{onChange:t=>a(b[parseInt(t.target.value)]),className:"w-full p-2 border rounded mb-2",children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),b.map((t,d)=>e.jsxs("option",{value:d,children:[t.name," -"," ",t.discountType==="amount"?`${t.discountValue}원`:`${t.discountValue}%`]},t.code))]}),c&&e.jsxs("p",{className:"text-green-600",children:["적용된 쿠폰: ",c.name,"(",c.discountType==="amount"?`${c.discountValue}원`:`${c.discountValue}%`," ","할인)"]})]}),e.jsxs("div",{className:"mt-6 bg-white p-4 rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"주문 요약"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:["상품 금액: ",u.toLocaleString(),"원"]}),e.jsxs("p",{className:"text-green-600",children:["할인 금액: ",j.toLocaleString(),"원"]}),e.jsxs("p",{className:"text-xl font-bold",children:["최종 결제 금액: ",o.toLocaleString(),"원"]})]})]})]})]})]})},M=({products:m,coupons:b,onProductUpdate:x,onProductAdd:y,onCouponAdd:g})=>{const[v,f]=h.useState(new Set),[a,c]=h.useState(null),[i,u]=h.useState({quantity:0,rate:0}),[o,j]=h.useState({name:"",code:"",discountType:"percentage",discountValue:0}),[w,C]=h.useState(!1),[t,d]=h.useState({name:"",price:0,stock:0,discounts:[]}),p=s=>{f(l=>{const n=new Set(l);return n.has(s)?n.delete(s):n.add(s),n})},N=s=>{c({...s})},k=(s,l)=>{if(a&&a.id===s){const n={...a,name:l};c(n)}},P=(s,l)=>{if(a&&a.id===s){const n={...a,price:l};c(n)}},S=()=>{a&&(x(a),c(null))},q=(s,l)=>{const n=m.find(r=>r.id===s);if(n){const r={...n,stock:l};x(r),c(r)}},A=s=>{const l=m.find(n=>n.id===s);if(l&&a){const n={...l,discounts:[...l.discounts,i]};x(n),c(n),u({quantity:0,rate:0})}},T=(s,l)=>{const n=m.find(r=>r.id===s);if(n){const r={...n,discounts:n.discounts.filter((O,I)=>I!==l)};x(r),c(r)}},D=()=>{g(o),j({name:"",code:"",discountType:"percentage",discountValue:0})},V=()=>{const s={...t,id:Date.now().toString()};y(s),d({name:"",price:0,stock:0,discounts:[]}),C(!1)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"관리자 페이지"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"상품 관리"}),e.jsx("button",{onClick:()=>C(!w),className:"bg-green-500 text-white px-4 py-2 rounded mb-4 hover:bg-green-600",children:w?"취소":"새 상품 추가"}),w&&e.jsxs("div",{className:"bg-white p-4 rounded shadow mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"새 상품 추가"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productName",className:"block text-sm font-medium text-gray-700",children:"상품명"}),e.jsx("input",{id:"productName",type:"text",value:t.name,onChange:s=>d({...t,name:s.target.value}),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productPrice",className:"block text-sm font-medium text-gray-700",children:"가격"}),e.jsx("input",{id:"productPrice",type:"number",value:t.price,onChange:s=>d({...t,price:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productStock",className:"block text-sm font-medium text-gray-700",children:"재고"}),e.jsx("input",{id:"productStock",type:"number",value:t.stock,onChange:s=>d({...t,stock:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsx("button",{onClick:V,className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"추가"})]}),e.jsx("div",{className:"space-y-2",children:m.map((s,l)=>e.jsxs("div",{"data-testid":`product-${l+1}`,className:"bg-white p-4 rounded shadow",children:[e.jsxs("button",{"data-testid":"toggle-button",onClick:()=>p(s.id),className:"w-full text-left font-semibold",children:[s.name," - ",s.price,"원 (재고: ",s.stock,")"]}),v.has(s.id)&&e.jsx("div",{className:"mt-2",children:a&&a.id===s.id?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"상품명: "}),e.jsx("input",{type:"text",value:a.name,onChange:n=>k(s.id,n.target.value),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"가격: "}),e.jsx("input",{type:"number",value:a.price,onChange:n=>P(s.id,parseInt(n.target.value)),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"재고: "}),e.jsx("input",{type:"number",value:a.stock,onChange:n=>q(s.id,parseInt(n.target.value)),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"할인 정보"}),a.discounts.map((n,r)=>e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{children:[n.quantity,"개 이상 구매 시 ",n.rate*100,"% 할인"]}),e.jsx("button",{onClick:()=>T(s.id,r),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"삭제"})]},r)),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"number",placeholder:"수량",value:i.quantity,onChange:n=>u({...i,quantity:parseInt(n.target.value)}),className:"w-1/3 p-2 border rounded"}),e.jsx("input",{type:"number",placeholder:"할인율 (%)",value:i.rate*100,onChange:n=>u({...i,rate:parseInt(n.target.value)/100}),className:"w-1/3 p-2 border rounded"}),e.jsx("button",{onClick:()=>A(s.id),className:"w-1/3 bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"할인 추가"})]})]}),e.jsx("button",{onClick:S,className:"bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 mt-2",children:"수정 완료"})]}):e.jsxs("div",{children:[s.discounts.map((n,r)=>e.jsx("div",{className:"mb-2",children:e.jsxs("span",{children:[n.quantity,"개 이상 구매 시 ",n.rate*100,"% 할인"]})},r)),e.jsx("button",{"data-testid":"modify-button",onClick:()=>N(s),className:"bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 mt-2",children:"수정"})]})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"쿠폰 관리"}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"쿠폰 이름",value:o.name,onChange:s=>j({...o,name:s.target.value}),className:"w-full p-2 border rounded"}),e.jsx("input",{type:"text",placeholder:"쿠폰 코드",value:o.code,onChange:s=>j({...o,code:s.target.value}),className:"w-full p-2 border rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:o.discountType,onChange:s=>j({...o,discountType:s.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"amount",children:"금액(원)"}),e.jsx("option",{value:"percentage",children:"할인율(%)"})]}),e.jsx("input",{type:"number",placeholder:"할인 값",value:o.discountValue,onChange:s=>j({...o,discountValue:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsx("button",{onClick:D,className:"w-full bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"쿠폰 추가"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"현재 쿠폰 목록"}),e.jsx("div",{className:"space-y-2",children:b.map((s,l)=>e.jsxs("div",{"data-testid":`coupon-${l+1}`,className:"bg-gray-100 p-2 rounded",children:[s.name," (",s.code,"):",s.discountType==="amount"?`${s.discountValue}원`:`${s.discountValue}%`," 할인"]},l))})]})]})]})]})]})},L=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}]},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}]},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2}]}],U=[{name:"5000원 할인 쿠폰",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인 쿠폰",code:"PERCENT10",discountType:"percentage",discountValue:10}],B=()=>{const[m,b]=h.useState(L),[x,y]=h.useState(U),[g,v]=h.useState(!1),f=i=>{b(u=>u.map(o=>o.id===i.id?i:o))},a=i=>{b(u=>[...u,i])},c=i=>{y(u=>[...u,i])};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-blue-600 text-white p-4",children:e.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"쇼핑몰 관리 시스템"}),e.jsx("button",{onClick:()=>v(!g),className:"bg-white text-blue-600 px-4 py-2 rounded hover:bg-blue-100",children:g?"장바구니 페이지로":"관리자 페이지로"})]})}),e.jsx("main",{className:"container mx-auto mt-6",children:g?e.jsx(M,{products:m,coupons:x,onProductUpdate:f,onProductAdd:a,onCouponAdd:c}):e.jsx(R,{products:m,coupons:x})})]})};F.createRoot(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(B,{})}));
